"""
ê¸°ì¡´ í•™ìŠµëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë˜ ë¹ ë¥¸ ì¶”ë¡  ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸
ì‚¬ìš©ë²•: python test_original_fast.py
"""
from src.summarizer import summarize
import time

def test_original_model_fast_mode():
    """ê¸°ì¡´ ëª¨ë¸ì˜ fast ëª¨ë“œ í…ŒìŠ¤íŠ¸"""
    
    print("=" * 70)
    print("ê¸°ì¡´ ëª¨ë¸ - Fast ëª¨ë“œ í…ŒìŠ¤íŠ¸ (Greedy Decoding)")
    print("=" * 70)
    
    # í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: ì§§ì€ í…ìŠ¤íŠ¸
    print("\n[í…ŒìŠ¤íŠ¸ 1] ì§§ì€ í…ìŠ¤íŠ¸ ìš”ì•½")
    print("-" * 70)
    text1 = """
    ì¸ê³µì§€ëŠ¥ ê¸°ìˆ ì´ ë¹ ë¥´ê²Œ ë°œì „í•˜ë©´ì„œ ë‹¤ì–‘í•œ ì‚°ì—… ë¶„ì•¼ì—ì„œ í™œìš©ë˜ê³  ìˆë‹¤. 
    íŠ¹íˆ ìì—°ì–´ ì²˜ë¦¬ ë¶„ì•¼ì—ì„œëŠ” ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸ì´ ë“±ì¥í•˜ì—¬ ê¸°ê³„ ë²ˆì—­, ìš”ì•½, ì§ˆì˜ì‘ë‹µ ë“±ì˜ ì‘ì—…ì—ì„œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì´ê³  ìˆë‹¤. 
    ì´ëŸ¬í•œ ê¸°ìˆ  ë°œì „ì€ ì•ìœ¼ë¡œ ë”ìš± ê°€ì†í™”ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë©°, ìš°ë¦¬ì˜ ì¼ìƒìƒí™œì—ë„ í° ë³€í™”ë¥¼ ê°€ì ¸ì˜¬ ê²ƒì´ë‹¤.
    """
    
    print(f"ì›ë¬¸ ê¸¸ì´: {len(text1)} ê¸€ì")
    start = time.time()
    summary1 = summarize(text1, fast=True)  # Fast ëª¨ë“œ ì‚¬ìš©
    elapsed1 = time.time() - start
    
    print(f"\nìš”ì•½ ê²°ê³¼:")
    print(f"  {summary1}")
    print(f"\nì†Œìš” ì‹œê°„: {elapsed1:.2f}ì´ˆ")
    print(f"ì²˜ë¦¬ ì†ë„: {len(text1) / elapsed1:.0f} ê¸€ì/ì´ˆ")
    
    # í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2: ì¤‘ê°„ ê¸¸ì´ í…ìŠ¤íŠ¸
    print("\n\n[í…ŒìŠ¤íŠ¸ 2] ì¤‘ê°„ ê¸¸ì´ í…ìŠ¤íŠ¸ ìš”ì•½")
    print("-" * 70)
    text2 = """
    ìµœê·¼ ì½”ë¡œë‚˜19 íŒ¬ë°ë¯¹ìœ¼ë¡œ ì¸í•´ ì „ ì„¸ê³„ ê²½ì œê°€ í° íƒ€ê²©ì„ ë°›ì•˜ë‹¤. 
    ë§ì€ ê¸°ì—…ë“¤ì´ ë¬¸ì„ ë‹«ì•˜ê³ , ìˆ˜ë§ì€ ì‚¬ëŒë“¤ì´ ì¼ìë¦¬ë¥¼ ìƒì—ˆë‹¤. 
    ì •ë¶€ë“¤ì€ ê²½ì œ íšŒë³µì„ ìœ„í•´ ë‹¤ì–‘í•œ ì •ì±…ì„ ì‹œí–‰í•˜ê³  ìˆìœ¼ë©°, íŠ¹íˆ ì¤‘ì†Œê¸°ì—… ì§€ì›ê³¼ ê³ ìš© ì•ˆì •ì— ì¤‘ì ì„ ë‘ê³  ìˆë‹¤. 
    ë˜í•œ ë””ì§€í„¸ ì „í™˜ì„ ê°€ì†í™”í•˜ì—¬ ìƒˆë¡œìš´ ì„±ì¥ ë™ë ¥ì„ ì°¾ìœ¼ë ¤ëŠ” ë…¸ë ¥ë„ ê³„ì†ë˜ê³  ìˆë‹¤. 
    ì´ëŸ¬í•œ ë…¸ë ¥ë“¤ì´ ê²°ì‹¤ì„ ë§ºì–´ ê²½ì œê°€ ì ì°¨ íšŒë³µì„¸ë¥¼ ë³´ì´ê³  ìˆì§€ë§Œ, ì—¬ì „íˆ ë§ì€ ë„ì „ ê³¼ì œê°€ ë‚¨ì•„ìˆë‹¤.
    """
    
    print(f"ì›ë¬¸ ê¸¸ì´: {len(text2)} ê¸€ì")
    start = time.time()
    summary2 = summarize(text2, fast=True)
    elapsed2 = time.time() - start
    
    print(f"\nìš”ì•½ ê²°ê³¼:")
    print(f"  {summary2}")
    print(f"\nì†Œìš” ì‹œê°„: {elapsed2:.2f}ì´ˆ")
    print(f"ì²˜ë¦¬ ì†ë„: {len(text2) / elapsed2:.0f} ê¸€ì/ì´ˆ")
    
    # í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 3: ê¸´ í…ìŠ¤íŠ¸
    print("\n\n[í…ŒìŠ¤íŠ¸ 3] ê¸´ í…ìŠ¤íŠ¸ ìš”ì•½")
    print("-" * 70)
    text3 = """
    ìµœê·¼ í™˜ìœ¨ì„ ë¹„ë¡¯í•œ ê°ì¢… ëŒ€ì™¸ ë³€ìˆ˜ë¡œ ì½”ìŠ¤í”¼ì§€ìˆ˜ ë³€ë™ì„±ì´ ê·¹ëŒ€í™”ëœ ê°€ìš´ë° í•œêµ­ì˜ ê°œì¸íˆ¬ììë“¤ì´ ì¥ë°‹ë¹› ì „ë§ì„ ë¯¿ê³  ë¹šê¹Œì§€ ë‚´ íˆ¬ìì— ë‚˜ì„œì ì£¼ìš” ì™¸ì‹ ë“¤ë„ ì´ë¥¼ ë¶ˆì•ˆí•˜ê²Œ ë°”ë¼ë³´ê³  ìˆë‹¤. 
    ê¸€ë¡œë²Œ 'í°ì†'ë“¤ì´ ì§‘ê²°í•œ ë¯¸êµ­ì—ì„œ ì•…ì¬ê°€ ë°œìƒí•´ë„ ê°œì¸ë“¤ì˜ ë§¤ìˆ˜ë¡œ ì§€ìˆ˜ í•˜ë½ì„ ë°©ì–´í•˜ëŠ” í˜•êµ­ì´ë¼ ìœ„í—˜ë„ê°€ ë” ë†’ì•„ì¡Œë‹¤ëŠ” ì§„ë‹¨ë„ ë‚˜ì˜¨ë‹¤. 
    íŠ¹íˆ ìµœê·¼ í•œêµ­ì˜ ì£¼ì‹ íˆ¬ì ì—´í’ì´ ì§‘ê°’ ê¸‰ë“±ê³¼ ì—°ê´€ë¼ ìˆë‹¤ê³  ë³´ëŠ” ì™¸ì‹ ë„ ë‚˜ì˜¤ê³  ìˆì–´ ëˆˆê¸¸ì„ ëŒê³  ìˆë‹¤. 
    ì •ë¶€ì˜ ë¶€ë™ì‚° ëŒ€ì±…ì´ ì‡ë”°ë¼ ì‹¤íŒ¨í•˜ê³  ì§‘ê°’ì´ ì²œì •ë¶€ì§€ë¡œ ì¹˜ì†Ÿì ìƒëŒ€ì  ë°•íƒˆê°ì„ ëŠë¼ê³  ì´ë¥¼ ë”°ë¼ì¡ê¸° ìœ„í•œ ì‚¬ëŒë“¤ì´ ë¬´ë¦¬ìˆ˜ë¥¼ ë‘ëŠ” ê²Œ ì•„ë‹ˆëƒëŠ” ì‹œê°ì´ë‹¤. 
    ë¯¸êµ­ì—ì„œ ì½”ìŠ¤í”¼ì‹œì¥ì— ëŒ€í•œ ë¶ˆì•ˆ ì‹¬ë¦¬ê°€ í™•ì‚°í• ìˆ˜ë¡ ì¦ì‹œ ìˆ˜ê¸‰ì—ëŠ” ë„ì›€ì´ ë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆì–´ ì›”ê°€ì˜ ì´ê°™ì€ ë¶€ì •ì  ì¸ì‹ì— ë‹¹ë¶„ê°„ ì£¼ëª©í•´ì•¼ í•  ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. 
    ì—¬ê¸°ì— í•œêµ­ íˆ¬ììë“¤ì´ ëª°ë¦¬ëŠ” ë¯¸êµ­ ì£¼ì‹ì˜ ë³€ë™ì„±ì´ ìµœê·¼ ê¸‰ê²©í•˜ê²Œ ì»¤ì§€ëŠ” ë° ëŒ€í•´ì„œë„ ì›”ê°€ì— ì¢‹ì§€ ì•Šì€ ì‹œì„ ì´ ëŠ˜ê³  ìˆëŠ” ë¶„ìœ„ê¸°ë‹¤. 
    ìì¹« ì›”ê°€ íˆ¬ììë“¤ì´ í•œêµ­ ê°œì¸ì´ íˆ¬ìí•œ ì£¼ì‹ì„ ìœ„í—˜ ì¢…ëª©ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³  ì™¸ë©´í•  ìˆ˜ë„ ìˆìŒì„ ê°ì•ˆí•´ì•¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.
    ë¸”ë£¼ë²„ê·¸í†µì‹ ì€ ì§€ë‚œ 12ì¼(í˜„ì§€ ì‹œê°„) ìµœê·¼ ì½”ìŠ¤í”¼ì‹œì¥ì— ëŒ€í•´ "í•œêµ­ ì£¼ì‹ ë³€ë™ì— ëŒ€í•œ ë² íŒ…ì´ ê¸‰ì¦í•˜ë©´ì„œ ì˜¬í•´ ê°€ì¥ ì¢‹ì€ ì„±ê³¼ë¥¼ ê±°ë‘” ì‹œì¥ì˜ ë ë¦¬ì— ëŒ€í•œ ìš°ë ¤ê°€ ì»¤ì§€ê³  ìˆë‹¤"ê³  ë¶„ì„í–ˆë‹¤. 
    ë¸”ë£¼ë²„ê·¸í†µì‹ ì€ "ì½”ìŠ¤í”¼200 ë³€ë™ì„±ì§€ìˆ˜ê°€ ë„ë„ë“œ íŠ¸ëŸ¼í”„ ë¯¸êµ­ ëŒ€í†µë ¹ì˜ ê´€ì„¸ë¡œ ì´‰ë°œëœ 4ì›” ì‹œì¥ ì¹¨ì²´ ë‹¹ì‹œ ìˆ˜ì¤€ìœ¼ë¡œ ë›°ì–´ì˜¬ëë‹¤"ë©° "ì´ëŠ” ë‹¤ë¥¸ ì‹œì¥ì€ ìƒëŒ€ì ìœ¼ë¡œ í‰ì˜¨í•œ ìƒíƒœì—ì„œ ë“œë¬¼ê²Œ ë²—ì–´ë‚œ ê¸‰ë“± í˜„ìƒ"ì´ë¼ê³  ì§€ì í–ˆë‹¤. 
    ì´ì–´ "ì˜¬í•´ ì½”ìŠ¤í”¼ëŠ” 1999ë…„ ì´í›„ ê°€ì¥ í° 73%ì˜ ì—°ê°„ ìƒìŠ¹í­ì„ ê¸°ë¡í•˜ë©° ì „ ì„¸ê³„ ë‹¤ë¥¸ ëª¨ë“  ì§€í‘œë¥¼ ëŠ¥ê°€í•˜ê³  ìˆë‹¤. 
    ì½”ìŠ¤í”¼200 ì§€ìˆ˜ëŠ” ì‚¼ì„±ì „ì(005930)ì™€ SKí•˜ì´ë‹‰ìŠ¤(000660)ì™€ ê°™ì€ ë°˜ë„ì²´ì£¼ ë•ë¶„ì— 85%ë¡œ ë” ë§ì´ ìƒìŠ¹í–ˆë‹¤"ë©° "ì½”ìŠ¤í”¼ ë³€ë™ì„±ì§€ìˆ˜(VKOSPI)ì™€ ë¯¸êµ­ ì‹œì¹´ê³ ì˜µì…˜ê±°ë˜ì†Œ(CBOE) ë³€ë™ì„±ì§€ìˆ˜(VIX) ê°„ ê²©ì°¨ê°€ 2004ë…„ ì´í›„ ìµœëŒ€ë¡œ ë²Œì–´ì¡Œë‹¤"ê³  ë§ë¶™ì˜€ë‹¤.
    VIXëŠ” í–¥í›„ 30ì¼ê°„ ìŠ¤íƒ ë”ë“œì•¤ë“œí‘¸ì–´ìŠ¤(S&P)500ì§€ìˆ˜ì˜ ë³€ë™ì„±ì— ëŒ€í•œ ì‹œì¥ ê¸°ëŒ€ë¥¼ ë°˜ì˜í•œ ì§€ìˆ˜ë¡œ 'ê³µí¬ ì§€ìˆ˜'ë¼ê³ ë„ ë¶ˆë¦°ë‹¤. 
    ì‹¤ì œ CNBCì— ë”°ë¥´ë©´ VKOSPIëŠ” ì§€ë‚œ 7ì¼ 41.88ì„ ê¸°ë¡í•´ íŠ¸ëŸ¼í”„ ëŒ€í†µë ¹ì˜ ìƒí˜¸ê´€ì„¸ ë°œí‘œë¡œ ì‹œì¥ì´ ê¸‰ë½í–ˆë˜ 4ì›” ìˆ˜ì¤€ìœ¼ë¡œ ì˜¬ëë‹¤. 
    ì´ ì§€ìˆ˜ëŠ” ìƒí˜¸ê´€ì„¸ ë°œí‘œ ì§í›„ì¸ ì˜¬ 4ì›” 7ì¼ 44.23ê¹Œì§€ ì¹˜ì†Ÿì•˜ë‹¤ê°€ ì´í›„ì—ëŠ” 10%ëŒ€ í›„ë°˜~20%ëŒ€ ì¤‘ë°˜ì— ë¨¸ë¬¼ë €ë‹¤. 
    ê·¸ëŸ¬ë‹¤ ìµœê·¼ ì½”ìŠ¤í”¼ì§€ìˆ˜ê°€ ë‹¤ì‹œ ê¸‰ë“±í•˜ë©´ì„œ ì§€ë‚œë‹¬ ì¤‘ìˆœë¶€í„° 30%ëŒ€ë¡œ ì¹˜ì†Ÿì•˜ë‹¤.
    """
    
    print(f"ì›ë¬¸ ê¸¸ì´: {len(text3)} ê¸€ì")
    start = time.time()
    summary3 = summarize(text3, fast=True)
    elapsed3 = time.time() - start
    
    print(f"\nìš”ì•½ ê²°ê³¼:")
    print(f"  {summary3}")
    print(f"\nì†Œìš” ì‹œê°„: {elapsed3:.2f}ì´ˆ")
    print(f"ì²˜ë¦¬ ì†ë„: {len(text3) / elapsed3:.0f} ê¸€ì/ì´ˆ")
    
    # Beam Searchì™€ ë¹„êµ
    print("\n\n[ë¹„êµ] Beam Search ëª¨ë“œ (ê³ í’ˆì§ˆ)")
    print("-" * 70)
    start = time.time()
    summary_beam = summarize(text2, fast=False)  # Beam Search
    elapsed_beam = time.time() - start
    
    print(f"ìš”ì•½: {summary_beam}")
    print(f"ì†Œìš” ì‹œê°„: {elapsed_beam:.2f}ì´ˆ")
    
    # ì„±ëŠ¥ ìš”ì•½
    print("\n\n" + "=" * 70)
    print("ì„±ëŠ¥ ìš”ì•½")
    print("=" * 70)
    print(f"Fast ëª¨ë“œ (Greedy):")
    print(f"  ì§§ì€ í…ìŠ¤íŠ¸:   {elapsed1:.2f}ì´ˆ")
    print(f"  ì¤‘ê°„ í…ìŠ¤íŠ¸:   {elapsed2:.2f}ì´ˆ")
    print(f"  ê¸´ í…ìŠ¤íŠ¸:     {elapsed3:.2f}ì´ˆ")
    print(f"\nBeam Search ëª¨ë“œ:")
    print(f"  ì¤‘ê°„ í…ìŠ¤íŠ¸:   {elapsed_beam:.2f}ì´ˆ")
    if elapsed_beam > 0 and elapsed2 > 0:
        print(f"\nì†ë„ í–¥ìƒ: {elapsed_beam/elapsed2:.2f}x ë¹ ë¦„")
    print("=" * 70)
    print("\nâœ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")
    print("\nğŸ’¡ ê¸°ì¡´ í•™ìŠµëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë˜ fast=True ì˜µì…˜ìœ¼ë¡œ ë¹ ë¥´ê²Œ ìš”ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")


if __name__ == "__main__":
    try:
        test_original_model_fast_mode()
    except Exception as e:
        print(f"\nì˜¤ë¥˜ ë°œìƒ: {e}")
        import traceback
        traceback.print_exc()

